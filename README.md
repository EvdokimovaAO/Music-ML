 # Кластеризация и классификация музыки. 
 ## Проектное задание по курсу Python, Институт Биоинформатики 2020/2021
 ### Над проектом работали: Алексей Замалутдинов, Анастасия Евдокимова, Валерий Черанев, Александра Примак & Проценко Людмила
 
 ## Поставленные задачи:
* сформировать датасэт и описание по жанрам
* отобрать фичи для файлов из датасета
* кластеризовать музыку и посмотреть как она кластеризуется - сделать графики, где будут видны реальные жанры песен и формируемые кластеры.
* сделать классификатор новых песен - чтобы мы могли подавать трэк, а он выдавал нам жанр трэка
 
  
 ## Часть 1. Подготовка данных.
 
 Для 324 композиций по 40 секундам с учетом пропуска первых 45 секунд от начала были извлечены такие показатели, как: 
* Mel-frequency cepstral coefficients
* Zero crossing rate
* Spectral centroid
* Spectral rolloff
* Beats per minute
* Spectral bandwidth
* Chroma frequencies (12 дорожек)
* Tonal centroid

В качестве основного жанра были указаны: 'pop': 21, 'jazz': 4, 'metal': 53, 'rock': 70, 'orchestral': 4, 'indie': 26, 'art_song': 3,
'hip-hop': 24, 'dance': 1, 'instrumental': 5, 'classic': 7, 'romance': 1, 'punk': 2, 'electronic': 50, 'blues': 1, 'rap': 1,
'alternative': 1, 'disco': 1, 'folk': 15, 'country': 3, 'audiobook': 1, 'ethnic': 2, 'britpop': 1, 'classics': 1, 'electro': 17,
 'trap': 1, 'new_age': 8

Несбалансированность групп сразу бросалась в глаза, и чтобы это не отразилось на последующих этапах работы, все композиции были отнесены к одному из следующих жанров: 'classic':8, 'electronic':79, 'pop':42, 'hip-hop':26, 'indie':27, 'instrumental':9, 'jazz':5, 'metal':53, 'rock':75. (Группы, в которые попали менее 10 песен были вручную переведены в группы более широкого жанра)

## Часть 2. Кластеризация датасета.

Перед кластеризацией был проведен PCA анализ, чтобы взглянуть на данные в зависимости от экстрагированных признаков. Результаты представлены на рисунке ниже.
Видно, что кластеры выделяются плохо, и ожидать качественной кластеризации вряд ли придется.

![image](https://user-images.githubusercontent.com/37074502/116681979-56c7aa80-a9b6-11eb-96bf-22c7697de662.png)

Действительно, алгоритм K-means посчитал, что наиболее хорошо подходят 2-3 кластера, в то время как хотелось бы около 9.

![image](https://user-images.githubusercontent.com/37074502/116683419-41538000-a9b8-11eb-8771-17341e484f2a.png)

![image](https://user-images.githubusercontent.com/37074502/116683432-47496100-a9b8-11eb-9247-dffb34e3b58d.png)

![image](https://user-images.githubusercontent.com/37074502/116683450-4d3f4200-a9b8-11eb-8a1a-58271fed32be.png)


### Часть 3. Создание классификатора музыки.

Для классификации музыки использовались два независимых алгоритма: RandomForest и нейросеть (CNN). 
Для RandomForest удалось добиться показателей recall 72% и 80% для групп metal и electronic, соответственно. Для групп rock, hip-hop recall составил менее 15% при показателе precision 25% для rock, 50% для hip-hop. Presicion для metal и electronic также были наилучшиими, составили 67% и 57%, соответственно. Жанр pop удалось предсказать с presicion 33%, recall 50%, а indie : presicion 50%, recall 44%. Учитывая неоднородность данных и результаты кластеризации, результаты получились лучше, чем можно было ожидать, accuracy = 53%. 

Нейросеть не показала хороших результатов при классификации, что скорее всего, объясняется также несбалансированностью выборок, сложностью в определении жанров и небольшим опытом работы с нейросетями. 

![image](https://user-images.githubusercontent.com/37074502/116700176-2b04ee80-a9cf-11eb-954c-36495ab08392.png)

![image](https://user-images.githubusercontent.com/37074502/116700209-32c49300-a9cf-11eb-8188-2ad71729d242.png)

